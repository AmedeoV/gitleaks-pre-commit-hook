# Custom Gitleaks Rules
# This file contains additional detection rules beyond the default gitleaks rules
# Copy this file to ~/.gitleaks-custom-rules.toml or use it as a reference
# The installation script automatically creates this file in your home directory

# Custom rule for database connection strings with passwords
[[rules]]
id = "database-connection-string"
description = "Detects database connection strings containing passwords (MySQL, PostgreSQL, SQL Server, etc.)"
regex = '''(?i)(server|host|data source|datasource)\s*=\s*[^;]+;\s*(port\s*=\s*[^;]+;\s*)?(database|initial catalog|db)\s*=\s*[^;]+;\s*(user id|uid|username|user)\s*=\s*[^;]+;\s*(password|pwd)\s*=\s*[^;\s"']{3,}'''
tags = ["database", "connection-string", "password"]

[[rules.Entropies]]
Min = "2.5"
Max = "8"

# Additional rule for generic password assignments
[[rules]]
id = "password-in-connection-string"
description = "Detects Pwd= or Password= with values in connection strings"
regex = '''(?i)(password|pwd)\s*=\s*["']?[a-zA-Z0-9!@#$%^&*()_+\-=\[\]{};:,.<>?/\\|`~]{8,}["']?'''
tags = ["password", "credentials"]

[[rules.Entropies]]
Min = "2.0"
Max = "8"

# Rule for generic API keys and secrets
[[rules]]
id = "generic-api-key"
description = "Detects generic API keys, secrets, and tokens"
regex = '''(?i)(api[_-]?key|api[_-]?secret|access[_-]?token|secret[_-]?key|private[_-]?key)\s*[=:]\s*["']?[a-zA-Z0-9_\-]{16,}["']?'''
tags = ["api-key", "token", "secret"]

[[rules.Entropies]]
Min = "3.0"
Max = "8"

# Add more custom rules below this line
# Example template:
# [[rules]]
# id = "my-custom-rule"
# description = "Description of what this rule detects"
# regex = '''your-regex-pattern-here'''
# tags = ["tag1", "tag2"]
#
# # Optional: Add entropy checking
# [[rules.Entropies]]
# Min = "3.0"
# Max = "8"

# Example: JWT tokens
# [[rules]]
# id = "jwt-token"
# description = "Detects JWT tokens"
# regex = '''eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'''
# tags = ["jwt", "token"]

# Example: Private SSH keys
# [[rules]]
# id = "ssh-private-key"
# description = "Detects private SSH keys"
# regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'''
# tags = ["ssh", "private-key"]

# Example: Hard-coded credentials in code
# [[rules]]
# id = "hardcoded-credentials"
# description = "Detects hard-coded usernames and passwords in code"
# regex = '''(?i)(username|user|login)\s*=\s*["'][^"']+["']\s*[,;]?\s*(password|passwd|pwd)\s*=\s*["'][^"']+["']'''
# tags = ["credentials", "hardcoded"]
