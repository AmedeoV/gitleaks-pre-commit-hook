# Gitleaks configuration file
# This is a sample/reference configuration for this repository
# 
# NOTE: The installation script creates a global configuration at ~/.gitleaks.toml
# that applies to all repositories automatically. You don't need this file unless
# you want repository-specific rules.
#
# To use custom rules globally:
# 1. Edit ~/.gitleaks-custom-rules.toml
# 2. Re-run the installation script to regenerate ~/.gitleaks.toml
#
# See gitleaks-custom-rules.toml in this repository for the template

[extend]
# Use the default gitleaks rules as a base
useDefault = true

# Custom rule for database connection strings with passwords
[[rules]]
id = "database-connection-string"
description = "Detects database connection strings containing passwords (MySQL, PostgreSQL, SQL Server, etc.)"
regex = '''(?i)(server|host|data source|datasource)\s*=\s*[^;]+;\s*(port\s*=\s*[^;]+;\s*)?(database|initial catalog|db)\s*=\s*[^;]+;\s*(user id|uid|username|user)\s*=\s*[^;]+;\s*(password|pwd)\s*=\s*[^;\s"']{3,}'''
tags = ["database", "connection-string", "password"]

[[rules.Entropies]]
Min = "2.5"
Max = "8"

# Additional rule for generic password assignments
[[rules]]
id = "password-in-connection-string"
description = "Detects Pwd= or Password= with values in connection strings"
regex = '''(?i)(password|pwd)\s*=\s*["']?[a-zA-Z0-9!@#$%^&*()_+\-=\[\]{};:,.<>?/\\|`~]{8,}["']?'''
tags = ["password", "credentials"]

[[rules.Entropies]]
Min = "2.0"
Max = "8"

# Rule for generic API keys and secrets
[[rules]]
id = "generic-api-key"
description = "Detects generic API keys, secrets, and tokens"
regex = '''(?i)(api[_-]?key|api[_-]?secret|access[_-]?token|secret[_-]?key|private[_-]?key)\s*[=:]\s*["']?[a-zA-Z0-9_\-]{16,}["']?'''
tags = ["api-key", "token", "secret"]

[[rules.Entropies]]
Min = "3.0"
Max = "8"

# Allow list - add false positives here if needed
# Uncomment and customize when you need to ignore specific patterns
# [allowlist]
# description = "Global allowlist"
# regexes = ['''example\.com''']
# paths = ['''.*test.*''']
